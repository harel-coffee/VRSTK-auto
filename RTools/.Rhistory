idvar = "subgroup",
timevar = "group",
direction = "wide")
print(data_base)
row.names(data_base) <- data_base$subgroup
data_base <- data_base[ , 2:ncol(data_base)]
colnames(data_base) <- c("group 1", "group 2", "group 3")
data_base <- as.matrix(data_base)
print(data_base)
barplot(height = data_base,                       # Grouped barplot using Base R
beside = TRUE)
col_names <- colnames(scale_ConscientiousFeaturesTrackedFromStage1[,(scale_columnConscientiousCounter - 2):scale_columnConscientiousCounter])
print(col_names)
data <- data.frame(values = c(4.685835e-14, -5.333234e-14, 6.068757e-14,
2.801925e-14, -2.499390e-14, -8.781517e-14,
9.064277e-14, -1.337958e-13, 1.383962e-14),
group = rep(c("Conscientious",
"None-Conscientious",
"Free"), each = 3), subgroup = col_names)
print(data)
data_base <- reshape(data,                        # Modify data for Base R barplot
idvar = "subgroup",
timevar = "group",
direction = "wide")
print(data_base)
row.names(data_base) <- data_base$subgroup
data_base <- data_base[ , 2:ncol(data_base)]
colnames(data_base) <- c("Conscientious", "None-Conscientious", "Free")
data_base <- as.matrix(data_base)
print(data_base)
barplot(height = data_base,                       # Grouped barplot using Base R
beside = TRUE)
barplot(colSums(scale_ConscientiousFeaturesTrackedFromStage1[,(scale_columnConscientiousCounter - 2):scale_columnConscientiousCounter]))
barplot(colSums(scale_NoneConscientiousFeaturesTrackedFromStage1[,(scale_columnNoneConscientiousCounter - 2):scale_columnNoneConscientiousCounter]))
barplot(colSums(scale_NoneFeaturesTrackedFromStage1[,(scale_columnNoneCounter - 2):scale_columnNoneCounter]))
barplot(height = data_base, beside = TRUE)
barplot(colSums(scale_NoneFeaturesTrackedFromStage1[,(scale_columnNoneCounter - 2):scale_columnNoneCounter]))
barplot(height = data_base, beside = TRUE)
ggplot(data, aes(x = group, y = values, fill = subgroup)) + geom_bar(stat = "identity", position = "dodge")
ggplot(data, aes(x = group, y = values, fill = subgroup)) + geom_bar(stat = "identity", position = "dodge")
barplot(height = data_base, beside = TRUE)
print(data)
print(con_columns_sum)
ggplot(data, aes(x = group, y = values, fill = subgroup)) + geom_bar(stat = "identity", position = "dodge")
for(stage in c("Stage0","Stage1", "Stage2")){
# load files
file_name <- paste("All_Participents_", stage, "_DataFrame.csv", sep="")
pathCSV <- file.path("./Condition A/RResults/", file_name, "")
conditionADataFrame <- read.csv2(file = pathCSV)
file_name <- paste("All_Participents_", stage, "_DataFrame.csv", sep="")
pathCSV <- file.path("./Condition B/RResults/", file_name, "")
conditionBDataFrame <- read.csv2(file = pathCSV)
#file_name <- paste("All_Participents_", stage, "_DataFrame.csv", sep="")
#pathCSV <- file.path("./Condition C/RResults/", file_name, "")
#conditionCDataFrame <- read.csv2(file = pathCSV)
# fuse all 3 conditions
all_participent_dataframe <- conditionADataFrame
all_participent_dataframe <- rbind(all_participent_dataframe, conditionBDataFrame)
#all_participent_dataframe <- rbind(all_participent_dataframe, conditionCDataFrame)
# create a copy of fused dataframe
temp_dataframe <- all_participent_dataframe
# all cells with "NA" = 0
#temp_dataframe <- replace(temp_dataframe, is.na(temp_dataframe), 0)
# all rows with "NA" to cut out
temp_dataframe <- na.omit(temp_dataframe)
# clean ids -> only numbers
temp_dataframe$pId <- str_replace(temp_dataframe$pId, "id-", "")
temp_dataframe$pId <- str_replace(temp_dataframe$pId, "b", "")
# switch time and id
numberOfColumns <- ncol(temp_dataframe)
temp_dataframe <- temp_dataframe[, c(2,1,3:numberOfColumns)]
# filter: remove unused/bad/const_to_zero/strings  columns
temp_dataframe <- subset(temp_dataframe, select=-c(lex))
if (stage != "Stage0"){
temp_dataframe <- subset(temp_dataframe, select=-c(STARTED, LASTDATA, MAXPAGE, DegTimeThreshold, DegTimeThresholdForOnePage, DegTimeValueForOnePage)) # MAXPAGE is optional
}
# convert all columns to numeric
numberOfColumns <- ncol(temp_dataframe)
temp_dataframe[,1:numberOfColumns] <- lapply(temp_dataframe[,1:numberOfColumns], function (x) as.numeric(x))
# save file
file_name <- paste("All_Participents_", stage, "_DataFrame.csv", sep="")
pathCSV <- file.path("./", file_name, "")
write.csv2(temp_dataframe, pathCSV, row.names = FALSE)
# clean up
rm(all_participent_dataframe)
rm(conditionADataFrame)
rm(conditionBDataFrame)
rm(conditionCDataFrame)
rm(temp_dataframe)
rm(list)
}
# automation build process
library(dplyr)
library(magrittr)
library(psych)
library(stringi)
library(stringr)
library(jsonlite)
library(glue)
library(magrittr)
library(mnormt)
for(stage in c("Stage0","Stage1", "Stage2")){
# load files
file_name <- paste("All_Participents_", stage, "_DataFrame.csv", sep="")
pathCSV <- file.path("./Condition A/RResults/", file_name, "")
conditionADataFrame <- read.csv2(file = pathCSV)
file_name <- paste("All_Participents_", stage, "_DataFrame.csv", sep="")
pathCSV <- file.path("./Condition B/RResults/", file_name, "")
conditionBDataFrame <- read.csv2(file = pathCSV)
#file_name <- paste("All_Participents_", stage, "_DataFrame.csv", sep="")
#pathCSV <- file.path("./Condition C/RResults/", file_name, "")
#conditionCDataFrame <- read.csv2(file = pathCSV)
# fuse all 3 conditions
all_participent_dataframe <- conditionADataFrame
all_participent_dataframe <- rbind(all_participent_dataframe, conditionBDataFrame)
#all_participent_dataframe <- rbind(all_participent_dataframe, conditionCDataFrame)
# create a copy of fused dataframe
temp_dataframe <- all_participent_dataframe
# all cells with "NA" = 0
#temp_dataframe <- replace(temp_dataframe, is.na(temp_dataframe), 0)
# all rows with "NA" to cut out
temp_dataframe <- na.omit(temp_dataframe)
# clean ids -> only numbers
temp_dataframe$pId <- str_replace(temp_dataframe$pId, "id-", "")
temp_dataframe$pId <- str_replace(temp_dataframe$pId, "b", "")
# switch time and id
numberOfColumns <- ncol(temp_dataframe)
temp_dataframe <- temp_dataframe[, c(2,1,3:numberOfColumns)]
# filter: remove unused/bad/const_to_zero/strings  columns
temp_dataframe <- subset(temp_dataframe, select=-c(lex))
if (stage != "Stage0"){
temp_dataframe <- subset(temp_dataframe, select=-c(STARTED, LASTDATA, MAXPAGE, DegTimeThreshold, DegTimeThresholdForOnePage, DegTimeValueForOnePage)) # MAXPAGE is optional
}
# convert all columns to numeric
numberOfColumns <- ncol(temp_dataframe)
temp_dataframe[,1:numberOfColumns] <- lapply(temp_dataframe[,1:numberOfColumns], function (x) as.numeric(x))
# save file
file_name <- paste("All_Participents_", stage, "_DataFrame.csv", sep="")
pathCSV <- file.path("./", file_name, "")
write.csv2(temp_dataframe, pathCSV, row.names = FALSE)
# clean up
rm(all_participent_dataframe)
rm(conditionADataFrame)
rm(conditionBDataFrame)
rm(conditionCDataFrame)
rm(temp_dataframe)
rm(list)
}
for (condition in c("Condition A", "Condition B")){#, "Condition C")){
condition_list <- NULL
if (str_detect(condition, "Condition A")){
# Conditions Ids:
# A -> id-1, id-2, id-3, id-4, id-5, id-6, id-7, id-10, (id-42 eeg-quality 0%) => 8 (9) Participents
condition_list <- c("id-1", "id-2", "id-3", "id-4", "id-5", "id-6", "id-7", "id-10")
} else if (str_detect(condition, "Condition B")){
# B -> id-13, id-14, id-15, id-16, id-17b, id-18, id-19, id-20, id-31, id-34, (id-25) 0 => optional participent because subjective it was a none-conscientious
condition_list <- c("id-13", "id-14", "id-15", "id-16", "id-17b", "id-18", "id-19", "id-20", "id-31", "id-34")
#condition_list <- c("id-13", "id-17b", "id-18", "id-19", "id-20", "id-31", "id-34")
} else if (str_detect(condition, "Condition C")){
# C -> id-21, id-22, id-22, id-23, id-24, id-25, id-26, id-27, id-28, id-29
condition_list <- c("id-21", "id-22", "id-23", "id-24", "id-25", "id-26", "id-27", "id-28", "id-29")
}
condition_length <- length(condition_list)
path <- file.path(condition,  "RResults", "/")
for(stage in c("Stage0","Stage1", "Stage2")){
All_Participents_Mean_DataFrame <- NULL
for (cid in condition_list){
dataframe_name <- paste("participent_", cid, "_", stage, "_DataFrame", sep="")
file_name <- paste (dataframe_name, ".csv", sep="")
pathCSV <- file.path(path,  file_name, "")
temp_dataframe <- read.csv2(file = pathCSV)
# alls cells with "NA" = 0
#temp_dataframe <- replace(temp_dataframe, is.na(temp_dataframe), 0)
# all rows with "NA" to cut out
temp_dataframe <- na.omit(temp_dataframe)
# clean ids -> only numbers
temp_dataframe$pId <- str_replace(temp_dataframe$pId, "id-", "")
temp_dataframe$pId <- str_replace(temp_dataframe$pId, "b", "")
# switch time and id
numberOfColumns <- ncol(temp_dataframe)
temp_dataframe <- temp_dataframe[, c(2,1,3:numberOfColumns)] # leave the row index blank to keep all rows
# filter: remove unused/bad/const_to_zero/strings  columns
temp_dataframe <- subset(temp_dataframe, select=-c(lex))
if (stage != "Stage0"){
temp_dataframe <- subset(temp_dataframe, select=-c(STARTED, LASTDATA, MAXPAGE, DegTimeThreshold, DegTimeThresholdForOnePage, DegTimeValueForOnePage)) # MAXPAGE is optional
}
# convert all columns to numeric
numberOfColumns <- ncol(temp_dataframe)
temp_dataframe[,1:numberOfColumns] <- lapply(temp_dataframe[,1:numberOfColumns], function (x) as.numeric(x))
meanArray <- colMeans(temp_dataframe)
temp_df <- data.frame(matrix(0, ncol = length(meanArray), nrow = 0))
temp_df <- rbind(temp_df, meanArray)
colnames(temp_df) <- colnames(temp_dataframe)
if(is.null(All_Participents_Mean_DataFrame)){
All_Participents_Mean_DataFrame <- temp_df
}else{
All_Participents_Mean_DataFrame <- rbind(All_Participents_Mean_DataFrame, temp_df)
}
}
file_name <- paste ("All_Participents_Mean_", stage, "_DataFrame.csv", sep="")
path_file <- file.path(path,  file_name, "")
write.csv2(All_Participents_Mean_DataFrame, path_file, row.names = FALSE)
}
}
for(stage in c("Stage0","Stage1", "Stage2")){
# load files
file_name <- paste("All_Participents_Mean_", stage, "_DataFrame.csv", sep="")
pathCSV <- file.path("./Condition A/RResults/", file_name, "")
conditionAMeanDataFrame <- read.csv2(file = pathCSV)
file_name <- paste("All_Participents_Mean_", stage, "_DataFrame.csv", sep="")
pathCSV <- file.path("./Condition B/RResults/", file_name, "")
conditionBMeanDataFrame <- read.csv2(file = pathCSV)
file_name <- paste("All_Participents_Mean_", stage, "_DataFrame.csv", sep="")
pathCSV <- file.path("./Condition C/RResults/", file_name, "")
conditionCMeanDataFrame <- read.csv2(file = pathCSV)
# fuse data frames
all_participent_Mean_dataframes <- conditionAMeanDataFrame
all_participent_Mean_dataframes <- rbind(all_participent_Mean_dataframes, conditionBMeanDataFrame)
all_participent_Mean_dataframes <- rbind(all_participent_Mean_dataframes, conditionCMeanDataFrame)
# save fused data frame
file_name <- paste("All_Participents_Mean_", stage, "_DataFrame.csv", sep="")
write.csv2(all_participent_Mean_dataframes, file_name, row.names = FALSE)
}
rm(all_participent_Mean_dataframes)
rm(All_Participents_Mean_DataFrame)
rm(conditionAMeanDataFrame)
rm(conditionBMeanDataFrame)
rm(conditionCMeanDataFrame)
rm(temp_dataframe)
rm(temp_df)
rm(cid)
rm(condition)
rm(condition_length)
rm(condition_list)
rm(dataframe_name)
rm(file_name)
rm(meanArray)
rm(path)
rm(path_file)
rm(numberOfColumns)
rm(pathCSV)
rm(stage)
# 14.3 create diff data frame from stage1 mean with stage0 mean data frame
# load files
file_name <- paste("All_Participents_Mean_Stage0_DataFrame.csv", sep="")
meanStage0DataFrame <- read.csv2(file = file_name)
file_name <- paste("All_Participents_Mean_Stage1_DataFrame.csv", sep="")
meanStage1DataFrame <- read.csv2(file = file_name)
cnames <- colnames(meanStage0DataFrame[,3:ncol(meanStage0DataFrame)])
allcnames <- colnames(meanStage1DataFrame)
desired_length = length(allcnames) - length(cnames)
filtertcnames <- vector(mode = "list", length = desired_length)
filtertcnames <- NULL
index <- 1
for (name in allcnames){
if(!(name %in% cnames)){
filtertcnames[index] <- name
index <- index + 1
}
}
temp_df <- meanStage1DataFrame[, cnames] - meanStage0DataFrame[, cnames]
temp_df <- cbind(meanStage1DataFrame[, filtertcnames], temp_df)
file_name <- paste("All_Participents_Mean_Diff_Of_Stages_DataFrame.csv", sep="")
write.csv2(temp_df, file_name, row.names = FALSE)
# 14.4 last cleanup stage
rm(allpagesTIMESUMsStage1)
rm(eyeTrackingSaccadesInformationStage1)
rm(meanStage0DataFrame)
rm(meanStage1DataFrame)
rm(pagesTIMESUMs)
rm(pagesTIMESUMsStage1CA)
rm(pagesTIMESUMsStage1CB)
rm(pagesTIMESUMsStage1CC)
rm(rawEyeTrackingSaccadesPositionsInformationStage1)
rm(rawFixationSaccadesPositionsDataStage1)
rm(temp_df)
rm(tempDataFrame)
rm(allcnames)
rm(c_index)
rm(countCa)
rm(countCB)
rm(countCC)
rm(file_name)
rm(file_name_csv)
rm(file_name_txt)
rm(filtertcnames)
rm(i)
rm(index)
rm(indexQ1)
rm(indexQ2)
rm(indexQ3)
rm(name)
rm(oldPageIndex)
rm(cnames)
rm(desired_length)
rm(pathTXT)
rm(medianTimeRsi)
rm(rawEyeTrackingSaccadesPositionsInformationStage1Temp)
rm(rawSaccadsPositionsInformationsAsMessage)
rm(replacedSaccade_0_Values)
rm(replacedSaccade_1_Values)
rm(q1XSaccads)
rm(q2XSaccads)
rm(q3XSaccads)
rm(rowModelName)
rm(rowModelNameIndex)
rm(saccade_0_position)
rm(saccade_1_position)
rm(splittedSaccadsPositionsInformations)
#--------------------------------------------------
#--------------------------------------------------
# 15. Run Cluster-Algorithm en
# using packages
library(ggplot2)
library(ggpubr)
library(tidyverse)
library(broom)
library(AICcmodavg)
library(Hmisc)
library(car)
library(ggstatsplot)
#### conscientious
# ===================================
# manuell clustert (0 = conscientious, 1 = none-conscientious)
# =======
# read csv file as data frame
allConscientiousFeaturesTrackedFromStage1 <- read.csv2(file = './Condition A/RResults/All_Participents_Stage1_DataFrame.csv')
allNoneConscientiousFeaturesTrackedFromStage1 <- read.csv2(file = './Condition B/RResults/All_Participents_Stage1_DataFrame.csv')
allNoneFeaturesTrackedFromStage1 <- read.csv2(file = './Condition C/RResults/All_Participents_Stage1_DataFrame.csv')
allFeaturesTrackedFromStage1 <- read.csv2(file = 'All_Participents_Stage1_DataFrame.csv')
allMeanFeaturesTrackedFromStage1 <- read.csv2(file = 'All_Participents_Mean_Stage1_DataFrame.csv')
# Condition A
temp <- allConscientiousFeaturesTrackedFromStage1
#================= 1 ============== 2 ============== 3 ============== 4 ============== 5 ============= 6 ============ 7 ============= 8 ============ 9 ============== 10 ============ 11 ============= 12 ============ 13 ============ 14 =====
temp$theta <- temp$AF3.theta + temp$F7.theta + temp$F3.theta + temp$FC5.theta + temp$T7.theta + temp$P7.theta + temp$O1.theta + temp$O2.theta + temp$P8.theta + temp$T8.theta + temp$AF4.theta + temp$F8.theta + temp$F4.theta + temp$FC6.theta
temp$alpha <- temp$AF3.alpha + temp$F7.alpha + temp$F3.alpha + temp$FC5.alpha + temp$T7.alpha + temp$P7.alpha + temp$O1.alpha + temp$O2.alpha + temp$P8.alpha + temp$T8.alpha + temp$AF4.alpha + temp$F8.alpha + temp$F4.alpha + temp$FC6.alpha
temp$betaL <- temp$AF3.betaL + temp$F7.betaL + temp$F3.betaL + temp$FC5.betaL + temp$T7.betaL + temp$P7.betaL + temp$O1.betaL + temp$O2.betaL + temp$P8.betaL + temp$T8.betaL + temp$AF4.betaL + temp$F8.betaL + temp$F4.betaL + temp$FC6.betaL
temp$betaH <- temp$AF3.betaH + temp$F7.betaH + temp$F3.betaH + temp$FC5.betaH + temp$T7.betaH + temp$P7.betaH + temp$O1.betaH + temp$O2.betaH + temp$P8.betaH + temp$T8.betaH + temp$AF4.betaH + temp$F8.betaH + temp$F4.betaH + temp$FC6.betaH
temp$gamma <- temp$AF3.gamma + temp$F7.gamma + temp$F3.gamma + temp$FC5.gamma + temp$T7.gamma + temp$P7.gamma + temp$O1.gamma + temp$O2.gamma + temp$P8.gamma + temp$T8.gamma + temp$AF4.gamma + temp$F8.gamma + temp$F4.gamma + temp$FC6.gamma
# eeg band power column number = 70 and begin with 10
allConscientiousFeaturesTrackedFromStage1 <- temp
columnConscientiousCounter <- ncol(allConscientiousFeaturesTrackedFromStage1)
barplot(colSums(allConscientiousFeaturesTrackedFromStage1[,(34):103]))
barplot(colSums(allConscientiousFeaturesTrackedFromStage1[,(columnConscientiousCounter - 4):columnConscientiousCounter]))
barplot(colSums(allConscientiousFeaturesTrackedFromStage1[,(columnConscientiousCounter - 2):columnConscientiousCounter]))
# Condition B
temp <- allNoneConscientiousFeaturesTrackedFromStage1
temp$theta <- temp$AF3.theta + temp$F7.theta + temp$F3.theta + temp$FC5.theta + temp$T7.theta + temp$P7.theta + temp$O1.theta + temp$O2.theta + temp$P8.theta + temp$T8.theta + temp$AF4.theta + temp$F8.theta + temp$F4.theta + temp$FC6.theta
temp$alpha <- temp$AF3.alpha + temp$F7.alpha + temp$F3.alpha + temp$FC5.alpha + temp$T7.alpha + temp$P7.alpha + temp$O1.alpha + temp$O2.alpha + temp$P8.alpha + temp$T8.alpha + temp$AF4.alpha + temp$F8.alpha + temp$F4.alpha + temp$FC6.alpha
temp$betaL <- temp$AF3.betaL + temp$F7.betaL + temp$F3.betaL + temp$FC5.betaL + temp$T7.betaL + temp$P7.betaL + temp$O1.betaL + temp$O2.betaL + temp$P8.betaL + temp$T8.betaL + temp$AF4.betaL + temp$F8.betaL + temp$F4.betaL + temp$FC6.betaL
temp$betaH <- temp$AF3.betaH + temp$F7.betaH + temp$F3.betaH + temp$FC5.betaH + temp$T7.betaH + temp$P7.betaH + temp$O1.betaH + temp$O2.betaH + temp$P8.betaH + temp$T8.betaH + temp$AF4.betaH + temp$F8.betaH + temp$F4.betaH + temp$FC6.betaH
temp$gamma <- temp$AF3.gamma + temp$F7.gamma + temp$F3.gamma + temp$FC5.gamma + temp$T7.gamma + temp$P7.gamma + temp$O1.gamma + temp$O2.gamma + temp$P8.gamma + temp$T8.gamma + temp$AF4.gamma + temp$F8.gamma + temp$F4.gamma + temp$FC6.gamma
allNoneConscientiousFeaturesTrackedFromStage1 <- temp
columnNoneConscientiousCounter <- ncol(allNoneConscientiousFeaturesTrackedFromStage1)
barplot(colSums(allNoneConscientiousFeaturesTrackedFromStage1[,(34):103]))
barplot(colSums(allNoneConscientiousFeaturesTrackedFromStage1[,(columnConscientiousCounter - 4):columnConscientiousCounter]))
barplot(colSums(allNoneConscientiousFeaturesTrackedFromStage1[,(columnConscientiousCounter - 2):columnConscientiousCounter]))
# Condition C
temp <- allNoneFeaturesTrackedFromStage1
temp$theta <- temp$AF3.theta + temp$F7.theta + temp$F3.theta + temp$FC5.theta + temp$T7.theta + temp$P7.theta + temp$O1.theta + temp$O2.theta + temp$P8.theta + temp$T8.theta + temp$AF4.theta + temp$F8.theta + temp$F4.theta + temp$FC6.theta
temp$alpha <- temp$AF3.alpha + temp$F7.alpha + temp$F3.alpha + temp$FC5.alpha + temp$T7.alpha + temp$P7.alpha + temp$O1.alpha + temp$O2.alpha + temp$P8.alpha + temp$T8.alpha + temp$AF4.alpha + temp$F8.alpha + temp$F4.alpha + temp$FC6.alpha
temp$betaL <- temp$AF3.betaL + temp$F7.betaL + temp$F3.betaL + temp$FC5.betaL + temp$T7.betaL + temp$P7.betaL + temp$O1.betaL + temp$O2.betaL + temp$P8.betaL + temp$T8.betaL + temp$AF4.betaL + temp$F8.betaL + temp$F4.betaL + temp$FC6.betaL
temp$betaH <- temp$AF3.betaH + temp$F7.betaH + temp$F3.betaH + temp$FC5.betaH + temp$T7.betaH + temp$P7.betaH + temp$O1.betaH + temp$O2.betaH + temp$P8.betaH + temp$T8.betaH + temp$AF4.betaH + temp$F8.betaH + temp$F4.betaH + temp$FC6.betaH
temp$gamma <- temp$AF3.gamma + temp$F7.gamma + temp$F3.gamma + temp$FC5.gamma + temp$T7.gamma + temp$P7.gamma + temp$O1.gamma + temp$O2.gamma + temp$P8.gamma + temp$T8.gamma + temp$AF4.gamma + temp$F8.gamma + temp$F4.gamma + temp$FC6.gamma
allNoneFeaturesTrackedFromStage1 <- temp
columnNoneCounter <- ncol(allNoneFeaturesTrackedFromStage1)
barplot(colSums(allNoneFeaturesTrackedFromStage1[,(34):103]))
barplot(colSums(allNoneFeaturesTrackedFromStage1[,(columnConscientiousCounter - 4):columnConscientiousCounter]))
barplot(colSums(allNoneFeaturesTrackedFromStage1[,(columnConscientiousCounter - 2):columnConscientiousCounter]))
write.csv2(allNoneFeaturesTrackedFromStage1, "All_Participents_Condition-C_WaveSum_DataFrame.csv", row.names = FALSE)
# Condition A-B-C
temp <- allFeaturesTrackedFromStage1
temp$theta <- temp$AF3.theta + temp$F7.theta + temp$F3.theta + temp$FC5.theta + temp$T7.theta + temp$P7.theta + temp$O1.theta + temp$O2.theta + temp$P8.theta + temp$T8.theta + temp$AF4.theta + temp$F8.theta + temp$F4.theta + temp$FC6.theta
temp$alpha <- temp$AF3.alpha + temp$F7.alpha + temp$F3.alpha + temp$FC5.alpha + temp$T7.alpha + temp$P7.alpha + temp$O1.alpha + temp$O2.alpha + temp$P8.alpha + temp$T8.alpha + temp$AF4.alpha + temp$F8.alpha + temp$F4.alpha + temp$FC6.alpha
temp$betaL <- temp$AF3.betaL + temp$F7.betaL + temp$F3.betaL + temp$FC5.betaL + temp$T7.betaL + temp$P7.betaL + temp$O1.betaL + temp$O2.betaL + temp$P8.betaL + temp$T8.betaL + temp$AF4.betaL + temp$F8.betaL + temp$F4.betaL + temp$FC6.betaL
temp$betaH <- temp$AF3.betaH + temp$F7.betaH + temp$F3.betaH + temp$FC5.betaH + temp$T7.betaH + temp$P7.betaH + temp$O1.betaH + temp$O2.betaH + temp$P8.betaH + temp$T8.betaH + temp$AF4.betaH + temp$F8.betaH + temp$F4.betaH + temp$FC6.betaH
temp$gamma <- temp$AF3.gamma + temp$F7.gamma + temp$F3.gamma + temp$FC5.gamma + temp$T7.gamma + temp$P7.gamma + temp$O1.gamma + temp$O2.gamma + temp$P8.gamma + temp$T8.gamma + temp$AF4.gamma + temp$F8.gamma + temp$F4.gamma + temp$FC6.gamma
allFeaturesTrackedFromStage1 <- temp
columnAllCounter <- ncol(allFeaturesTrackedFromStage1)
barplot(colSums(allFeaturesTrackedFromStage1[,(34):103]))
barplot(colSums(allFeaturesTrackedFromStage1[,(columnAllCounter - 4):columnAllCounter]))
barplot(colSums(allFeaturesTrackedFromStage1[,(columnAllCounter - 2):columnAllCounter]))
write.csv2(allFeaturesTrackedFromStage1, "All_Participents_WaveSum_DataFrame.csv", row.names = FALSE)
# Condition A-B-C Mean
temp <- allMeanFeaturesTrackedFromStage1
temp$theta <- temp$AF3.theta + temp$F7.theta + temp$F3.theta + temp$FC5.theta + temp$T7.theta + temp$P7.theta + temp$O1.theta + temp$O2.theta + temp$P8.theta + temp$T8.theta + temp$AF4.theta + temp$F8.theta + temp$F4.theta + temp$FC6.theta
temp$alpha <- temp$AF3.alpha + temp$F7.alpha + temp$F3.alpha + temp$FC5.alpha + temp$T7.alpha + temp$P7.alpha + temp$O1.alpha + temp$O2.alpha + temp$P8.alpha + temp$T8.alpha + temp$AF4.alpha + temp$F8.alpha + temp$F4.alpha + temp$FC6.alpha
temp$betaL <- temp$AF3.betaL + temp$F7.betaL + temp$F3.betaL + temp$FC5.betaL + temp$T7.betaL + temp$P7.betaL + temp$O1.betaL + temp$O2.betaL + temp$P8.betaL + temp$T8.betaL + temp$AF4.betaL + temp$F8.betaL + temp$F4.betaL + temp$FC6.betaL
temp$betaH <- temp$AF3.betaH + temp$F7.betaH + temp$F3.betaH + temp$FC5.betaH + temp$T7.betaH + temp$P7.betaH + temp$O1.betaH + temp$O2.betaH + temp$P8.betaH + temp$T8.betaH + temp$AF4.betaH + temp$F8.betaH + temp$F4.betaH + temp$FC6.betaH
temp$gamma <- temp$AF3.gamma + temp$F7.gamma + temp$F3.gamma + temp$FC5.gamma + temp$T7.gamma + temp$P7.gamma + temp$O1.gamma + temp$O2.gamma + temp$P8.gamma + temp$T8.gamma + temp$AF4.gamma + temp$F8.gamma + temp$F4.gamma + temp$FC6.gamma
allMeanFeaturesTrackedFromStage1 <- temp
columnAllMeanCounter <- ncol(allMeanFeaturesTrackedFromStage1)
barplot(colSums(allMeanFeaturesTrackedFromStage1[,(34):103]))
barplot(colSums(allMeanFeaturesTrackedFromStage1[,(columnAllMeanCounter - 4):columnAllMeanCounter]))
barplot(colSums(allMeanFeaturesTrackedFromStage1[,(columnAllMeanCounter - 2):columnAllMeanCounter]))
write.csv2(allMeanFeaturesTrackedFromStage1, "All_Participents_WaveSum_Mean_DataFrame.csv", row.names = FALSE)
rowConscientiousCounter     <- nrow(allConscientiousFeaturesTrackedFromStage1)
rowNoneConscientiousCounter <- nrow(allNoneConscientiousFeaturesTrackedFromStage1)
#rowNoneCounter              <- nrow(allNoneFeaturesTrackedFromStage1)
rowAllCounter               <- nrow(allFeaturesTrackedFromStage1)
# ANOVA test one-way (overall variance of the data, statistically significant)
any.way <- aov(EvaluatedGlobalTIMERSICalc ~ ., data = allFeaturesTrackedFromStage1)
# create descriptive statistic
summary(any.way)
# ANOVA test one-way (overall variance of the data, statistically significant)
any.way <- aov(DegTimeLowQuality ~ ., data = allFeaturesTrackedFromStage1)
# create descriptive statistic
summary(any.way)
# Condition A
scale_ConscientiousFeaturesTrackedFromStage1 <- allConscientiousFeaturesTrackedFromStage1
scale_ConscientiousFeaturesTrackedFromStage1 <- subset(scale_ConscientiousFeaturesTrackedFromStage1, , -pId )
scale_ConscientiousFeaturesTrackedFromStage1 <- subset(scale_ConscientiousFeaturesTrackedFromStage1, , -STARTED )
scale_ConscientiousFeaturesTrackedFromStage1 <- subset(scale_ConscientiousFeaturesTrackedFromStage1, , -LASTDATA )
scale_ConscientiousFeaturesTrackedFromStage1 <- as.data.frame(scale(scale_ConscientiousFeaturesTrackedFromStage1))
scale_columnConscientiousCounter <- ncol(scale_ConscientiousFeaturesTrackedFromStage1)
barplot(colSums(scale_ConscientiousFeaturesTrackedFromStage1[,(scale_columnConscientiousCounter - 4):scale_columnConscientiousCounter]))
barplot(colSums(scale_ConscientiousFeaturesTrackedFromStage1[,(scale_columnConscientiousCounter - 2):scale_columnConscientiousCounter]))
# Condition B
scale_NoneConscientiousFeaturesTrackedFromStage1 <- allNoneConscientiousFeaturesTrackedFromStage1
scale_NoneConscientiousFeaturesTrackedFromStage1 <- subset(scale_NoneConscientiousFeaturesTrackedFromStage1, , -pId  )
scale_NoneConscientiousFeaturesTrackedFromStage1 <- subset(scale_NoneConscientiousFeaturesTrackedFromStage1, , -STARTED )
scale_NoneConscientiousFeaturesTrackedFromStage1 <- subset(scale_NoneConscientiousFeaturesTrackedFromStage1, , -LASTDATA )
scale_NoneConscientiousFeaturesTrackedFromStage1 <- as.data.frame(scale(scale_NoneConscientiousFeaturesTrackedFromStage1))
scale_columnNoneConscientiousCounter <- ncol(scale_NoneConscientiousFeaturesTrackedFromStage1)
barplot(colSums(scale_NoneConscientiousFeaturesTrackedFromStage1[,(scale_columnNoneConscientiousCounter - 4):scale_columnNoneConscientiousCounter]))
barplot(colSums(scale_NoneConscientiousFeaturesTrackedFromStage1[,(scale_columnNoneConscientiousCounter - 2):scale_columnNoneConscientiousCounter]))
# Condition C
scale_NoneFeaturesTrackedFromStage1 <- allNoneFeaturesTrackedFromStage1
scale_NoneFeaturesTrackedFromStage1 <- subset(scale_NoneFeaturesTrackedFromStage1, , -pId )
scale_NoneFeaturesTrackedFromStage1 <- subset(scale_NoneFeaturesTrackedFromStage1, , -STARTED )
scale_NoneFeaturesTrackedFromStage1 <- subset(scale_NoneFeaturesTrackedFromStage1, , -LASTDATA )
scale_NoneFeaturesTrackedFromStage1 <- as.data.frame(scale(scale_NoneFeaturesTrackedFromStage1))
scale_columnNoneCounter <- ncol(scale_NoneFeaturesTrackedFromStage1)
barplot(colSums(scale_NoneFeaturesTrackedFromStage1[,(scale_columnNoneCounter - 4):scale_columnNoneCounter]))
barplot(colSums(scale_NoneFeaturesTrackedFromStage1[,(scale_columnNoneCounter - 2):scale_columnNoneCounter]))
con_columns_sum <- colSums(scale_ConscientiousFeaturesTrackedFromStage1[,(scale_columnConscientiousCounter - 2):scale_columnConscientiousCounter])
none_con_columns_sum <- colSums(scale_NoneConscientiousFeaturesTrackedFromStage1[,(scale_columnNoneConscientiousCounter - 2):scale_columnNoneConscientiousCounter])
none_features_columns_sum <- colSums(scale_NoneFeaturesTrackedFromStage1[,(scale_columnNoneCounter - 2):scale_columnNoneCounter])
print(con_columns_sum)
print(none_con_columns_sum)
print(none_features_columns_sum)
col_names <- colnames(scale_ConscientiousFeaturesTrackedFromStage1[,(scale_columnConscientiousCounter - 2):scale_columnConscientiousCounter])
print(col_names)
data <- data.frame(values = c(8.383442e-14, -4.973799e-14, 1.473821e-14,
-8.710047e-14, 3.001072e-14, -2.008810e-14,
7.211245e-14, -5.431506e-14, 9.946688e-14),
group = rep(c("Conscientious",
"None-Conscientious",
"Free"), each = 3), subgroup = col_names)
print(data)
data_base <- reshape(data, idvar = "subgroup", timevar = "group", direction = "wide")
print(data_base)
row.names(data_base) <- data_base$subgroup
data_base <- data_base[ , 2:ncol(data_base)]
colnames(data_base) <- c("Conscientious", "None-Conscientious", "Free")
data_base <- as.matrix(data_base)
print(data_base)
# ----- group data barplot
barplot(height = data_base, beside = TRUE)
ggplot(data, aes(x = group, y = values, fill = subgroup)) + geom_bar(stat = "identity", position = "dodge")
# only if Condition A-B manuel set to clusters (Conscientious = 0 and None-Conscientious = 1)
# =======================================================================================================================
allFeaturesTrackedFromStage1$Conscientious <- 1
allFeaturesTrackedFromStage1$Conscientious[1:rowConscientiousCounter] <- 0
write.csv2(allFeaturesTrackedFromStage1, "All_Participents_Clusterd_WaveSum_DataFrame.csv", row.names = FALSE)
write.csv2(allNoneFeaturesTrackedFromStage1, "All_Participents_Condition-C_WaveSum_DataFrame.csv", row.names = FALSE)
allNoneFeaturesTrackedFromStage1 <- read.csv2(file = './Condition C/RResults/All_Participents_Stage1_DataFrame.csv')
# Condition C
temp <- allNoneFeaturesTrackedFromStage1
temp$theta <- temp$AF3.theta + temp$F7.theta + temp$F3.theta + temp$FC5.theta + temp$T7.theta + temp$P7.theta + temp$O1.theta + temp$O2.theta + temp$P8.theta + temp$T8.theta + temp$AF4.theta + temp$F8.theta + temp$F4.theta + temp$FC6.theta
temp$alpha <- temp$AF3.alpha + temp$F7.alpha + temp$F3.alpha + temp$FC5.alpha + temp$T7.alpha + temp$P7.alpha + temp$O1.alpha + temp$O2.alpha + temp$P8.alpha + temp$T8.alpha + temp$AF4.alpha + temp$F8.alpha + temp$F4.alpha + temp$FC6.alpha
temp$betaL <- temp$AF3.betaL + temp$F7.betaL + temp$F3.betaL + temp$FC5.betaL + temp$T7.betaL + temp$P7.betaL + temp$O1.betaL + temp$O2.betaL + temp$P8.betaL + temp$T8.betaL + temp$AF4.betaL + temp$F8.betaL + temp$F4.betaL + temp$FC6.betaL
temp$betaH <- temp$AF3.betaH + temp$F7.betaH + temp$F3.betaH + temp$FC5.betaH + temp$T7.betaH + temp$P7.betaH + temp$O1.betaH + temp$O2.betaH + temp$P8.betaH + temp$T8.betaH + temp$AF4.betaH + temp$F8.betaH + temp$F4.betaH + temp$FC6.betaH
temp$gamma <- temp$AF3.gamma + temp$F7.gamma + temp$F3.gamma + temp$FC5.gamma + temp$T7.gamma + temp$P7.gamma + temp$O1.gamma + temp$O2.gamma + temp$P8.gamma + temp$T8.gamma + temp$AF4.gamma + temp$F8.gamma + temp$F4.gamma + temp$FC6.gamma
allNoneFeaturesTrackedFromStage1 <- temp
columnNoneCounter <- ncol(allNoneFeaturesTrackedFromStage1)
barplot(colSums(allNoneFeaturesTrackedFromStage1[,(34):103]))
barplot(colSums(allNoneFeaturesTrackedFromStage1[,(columnConscientiousCounter - 4):columnConscientiousCounter]))
barplot(colSums(allNoneFeaturesTrackedFromStage1[,(columnConscientiousCounter - 2):columnConscientiousCounter]))
# clean ids -> only numbers
allNoneFeaturesTrackedFromStage1$pId <- str_replace(allNoneFeaturesTrackedFromStage1$pId, "id-", "")
allNoneFeaturesTrackedFromStage1$pId <- str_replace(allNoneFeaturesTrackedFromStage1$pId, "b", "")
write.csv2(allNoneFeaturesTrackedFromStage1, "All_Participents_Condition-C_WaveSum_DataFrame.csv", row.names = FALSE)
allNoneFeaturesTrackedFromStage1 <- read.csv2(file = './Condition C/RResults/All_Participents_Stage1_DataFrame.csv')
# Condition C
temp <- allNoneFeaturesTrackedFromStage1
temp$theta <- temp$AF3.theta + temp$F7.theta + temp$F3.theta + temp$FC5.theta + temp$T7.theta + temp$P7.theta + temp$O1.theta + temp$O2.theta + temp$P8.theta + temp$T8.theta + temp$AF4.theta + temp$F8.theta + temp$F4.theta + temp$FC6.theta
temp$alpha <- temp$AF3.alpha + temp$F7.alpha + temp$F3.alpha + temp$FC5.alpha + temp$T7.alpha + temp$P7.alpha + temp$O1.alpha + temp$O2.alpha + temp$P8.alpha + temp$T8.alpha + temp$AF4.alpha + temp$F8.alpha + temp$F4.alpha + temp$FC6.alpha
temp$betaL <- temp$AF3.betaL + temp$F7.betaL + temp$F3.betaL + temp$FC5.betaL + temp$T7.betaL + temp$P7.betaL + temp$O1.betaL + temp$O2.betaL + temp$P8.betaL + temp$T8.betaL + temp$AF4.betaL + temp$F8.betaL + temp$F4.betaL + temp$FC6.betaL
temp$betaH <- temp$AF3.betaH + temp$F7.betaH + temp$F3.betaH + temp$FC5.betaH + temp$T7.betaH + temp$P7.betaH + temp$O1.betaH + temp$O2.betaH + temp$P8.betaH + temp$T8.betaH + temp$AF4.betaH + temp$F8.betaH + temp$F4.betaH + temp$FC6.betaH
temp$gamma <- temp$AF3.gamma + temp$F7.gamma + temp$F3.gamma + temp$FC5.gamma + temp$T7.gamma + temp$P7.gamma + temp$O1.gamma + temp$O2.gamma + temp$P8.gamma + temp$T8.gamma + temp$AF4.gamma + temp$F8.gamma + temp$F4.gamma + temp$FC6.gamma
allNoneFeaturesTrackedFromStage1 <- temp
columnNoneCounter <- ncol(allNoneFeaturesTrackedFromStage1)
barplot(colSums(allNoneFeaturesTrackedFromStage1[,(34):103]))
barplot(colSums(allNoneFeaturesTrackedFromStage1[,(columnConscientiousCounter - 4):columnConscientiousCounter]))
barplot(colSums(allNoneFeaturesTrackedFromStage1[,(columnConscientiousCounter - 2):columnConscientiousCounter]))
# Filter C Condition data frame
# alls cells with "NA" = 0, all rows with "NA" to cut out
allNoneFeaturesTrackedFromStage1 <- na.omit(allNoneFeaturesTrackedFromStage1)
# clean ids -> only numbers
allNoneFeaturesTrackedFromStage1$pId <- str_replace(allNoneFeaturesTrackedFromStage1$pId, "id-", "")
allNoneFeaturesTrackedFromStage1$pId <- str_replace(allNoneFeaturesTrackedFromStage1$pId, "b", "")
# switch time and id
numberOfColumns <- ncol(allNoneFeaturesTrackedFromStage1)
allNoneFeaturesTrackedFromStage1 <- allNoneFeaturesTrackedFromStage1[, c(2,1,3:numberOfColumns)] # leave the row index blank to keep all rows
# filter: remove unused/bad/const_to_zero/strings  columns
allNoneFeaturesTrackedFromStage1 <- subset(allNoneFeaturesTrackedFromStage1, select=-c(lex))
allNoneFeaturesTrackedFromStage1 <- subset(allNoneFeaturesTrackedFromStage1, select=-c(STARTED, LASTDATA, MAXPAGE, DegTimeThreshold, DegTimeThresholdForOnePage, DegTimeValueForOnePage)) # MAXPAGE is optional
# convert all columns to numeric
numberOfColumns <- ncol(allNoneFeaturesTrackedFromStage1)
allNoneFeaturesTrackedFromStage1[,1:numberOfColumns] <- lapply(allNoneFeaturesTrackedFromStage1[,1:numberOfColumns], function (x) as.numeric(x))
write.csv2(allNoneFeaturesTrackedFromStage1, "All_Participents_Condition-C_WaveSum_DataFrame.csv", row.names = FALSE)
